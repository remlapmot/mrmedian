-------------------------------------------------------------------------------
      name:  mrmvivw
       log:  C:\Users\tom\Documents\GitHub\mrrobust\cscripts\mrmvivw.log
  log type:  text
 opened on:  27 Jun 2020, 22:57:03

. * mrmvivw cscript
. * 22jun2020
. 
. cscript mrmvivw adofiles mrmvivw mvivw mvmr
------------------------------------------------------------------BEGIN mrmvivw

-> which mrmvivw, usesysdir
C:\Users\tom\Documents\GitHub\mrrobust\mrmvivw.ado
*! version 0.1.0 22jun2020 Tom Palmer

-> which mvivw, usesysdir
C:\Users\tom\Documents\GitHub\mrrobust\mvivw.ado
*! version 0.1.0 22jun2020 Tom Palmer

-> which mvmr, usesysdir
C:\Users\tom\Documents\GitHub\mrrobust\mvmr.ado
*! version 0.1.0 22jun2020 Tom Palmer

. 
. * load in dataset
. use https://raw.github.com/remlapmot/mrrobust/master/dodata, clear

. 
. * ldlc - analysis 1
. gen byte sel1 = (ldlcp2 < 1e-8)

. 
. * check univariate estimate
. 
. mregger chdbeta ldlcbeta [aw=1/(chdse^2)] if sel1==1, ivw fe

                                                      Number of genotypes = 73
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
chdbeta      |
    ldlcbeta |   .4815055    .038221    12.60   0.000     .4065938    .5564173
------------------------------------------------------------------------------

. 
. discard

. mrmvivw chdbeta ldlcbeta [aw=1/(chdse^2)] if sel1==1, fe

                                                       Number of genotypes: 73
                                                 Standard errors: Fixed effect
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
chdbeta      |
    ldlcbeta |   .4815055    .038221    12.60   0.000     .4065938    .5564173
------------------------------------------------------------------------------

. assert abs(_b[ldlcbeta] - .482) < 1e-3

. assert abs(_se[ldlcbeta] - .038) < 1e-3

. 
. * r(table)
. mat list r(table)

r(table)[9,1]
          chdbeta:
         ldlcbeta
     b  .48150551
    se  .03822098
     z  12.597937
pvalue  2.167e-36
    ll  .40659377
    ul  .55641726
    df          .
  crit   1.959964
 eform          0

. 
. discard

. mvivw chdbeta ldlcbeta [aw=1/(chdse^2)] if sel1==1, fe

                                                       Number of genotypes: 73
                                                 Standard errors: Fixed effect
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
chdbeta      |
    ldlcbeta |   .4815055    .038221    12.60   0.000     .4065938    .5564173
------------------------------------------------------------------------------

. assert abs(_b[ldlcbeta] - .482) < 1e-3

. assert abs(_se[ldlcbeta] - .038) < 1e-3

. 
. discard

. mvmr chdbeta ldlcbeta [aw=1/(chdse^2)] if sel1==1, fe

                                                       Number of genotypes: 73
                                                 Standard errors: Fixed effect
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
chdbeta      |
    ldlcbeta |   .4815055    .038221    12.60   0.000     .4065938    .5564173
------------------------------------------------------------------------------

. assert abs(_b[ldlcbeta] - .482) < 1e-3

. assert abs(_se[ldlcbeta] - .038) < 1e-3

. 
. * fit a multivariate estimate
. 
. ** without FE SEs
. discard

. mrmvivw chdbeta ldlcbeta hdlcbeta tgbeta [aw=1/(chdse^2)] if sel1==1

                                                       Number of genotypes: 73
                                                Standard errors: Random effect
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
chdbeta      |
    ldlcbeta |     .42862   .0609661     7.03   0.000     .3091286    .5481113
    hdlcbeta |  -.1941989   .1308289    -1.48   0.138    -.4506189    .0622211
      tgbeta |   .2260456   .1232828     1.83   0.067    -.0155842    .4676755
------------------------------------------------------------------------------

. assert abs(_b[ldlcbeta] - .429) < 1e-3

. assert abs(_se[ldlcbeta] - .061) < 1e-3

. assert abs(_b[hdlcbeta] - -.194) < 1e-3

. assert abs(_se[hdlcbeta] - .131) < 1e-3

. assert abs(_b[tgbeta] - .226) < 1e-3

. assert abs(_se[tgbeta] - .123) < 1e-3

. 
. discard

. mvivw chdbeta ldlcbeta hdlcbeta tgbeta [aw=1/(chdse^2)] if sel1==1

                                                       Number of genotypes: 73
                                                Standard errors: Random effect
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
chdbeta      |
    ldlcbeta |     .42862   .0609661     7.03   0.000     .3091286    .5481113
    hdlcbeta |  -.1941989   .1308289    -1.48   0.138    -.4506189    .0622211
      tgbeta |   .2260456   .1232828     1.83   0.067    -.0155842    .4676755
------------------------------------------------------------------------------

. assert abs(_b[ldlcbeta] - .429) < 1e-3

. assert abs(_se[ldlcbeta] - .061) < 1e-3

. assert abs(_b[hdlcbeta] - -.194) < 1e-3

. assert abs(_se[hdlcbeta] - .131) < 1e-3

. assert abs(_b[tgbeta] - .226) < 1e-3

. assert abs(_se[tgbeta] - .123) < 1e-3

. 
. discard

. mvmr chdbeta ldlcbeta hdlcbeta tgbeta [aw=1/(chdse^2)] if sel1==1

                                                       Number of genotypes: 73
                                                Standard errors: Random effect
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
chdbeta      |
    ldlcbeta |     .42862   .0609661     7.03   0.000     .3091286    .5481113
    hdlcbeta |  -.1941989   .1308289    -1.48   0.138    -.4506189    .0622211
      tgbeta |   .2260456   .1232828     1.83   0.067    -.0155842    .4676755
------------------------------------------------------------------------------

. assert abs(_b[ldlcbeta] - .429) < 1e-3

. assert abs(_se[ldlcbeta] - .061) < 1e-3

. assert abs(_b[hdlcbeta] - -.194) < 1e-3

. assert abs(_se[hdlcbeta] - .131) < 1e-3

. assert abs(_b[tgbeta] - .226) < 1e-3

. assert abs(_se[tgbeta] - .123) < 1e-3

. 
. ** with FE SEs
. discard

. mrmvivw chdbeta ldlcbeta hdlcbeta tgbeta [aw=1/(chdse^2)] if sel1==1, fe

                                                       Number of genotypes: 73
                                                 Standard errors: Fixed effect
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
chdbeta      |
    ldlcbeta |     .42862   .0409208    10.47   0.000     .3484166    .5088234
    hdlcbeta |  -.1941989   .0878132    -2.21   0.027    -.3663097   -.0220881
      tgbeta |   .2260456   .0827482     2.73   0.006     .0638621    .3882291
------------------------------------------------------------------------------

. assert abs(_b[ldlcbeta] - .429) < 1e-3

. assert abs(_se[ldlcbeta] - .041) < 1e-3

. assert abs(_b[hdlcbeta] - -.194) < 1e-3

. assert abs(_se[hdlcbeta] - .088) < 1e-3

. assert abs(_b[tgbeta] - .226) < 1e-3

. assert abs(_se[tgbeta] - .083) < 1e-3

. 
. discard

. mvivw chdbeta ldlcbeta hdlcbeta tgbeta [aw=1/(chdse^2)] if sel1==1, fe

                                                       Number of genotypes: 73
                                                 Standard errors: Fixed effect
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
chdbeta      |
    ldlcbeta |     .42862   .0409208    10.47   0.000     .3484166    .5088234
    hdlcbeta |  -.1941989   .0878132    -2.21   0.027    -.3663097   -.0220881
      tgbeta |   .2260456   .0827482     2.73   0.006     .0638621    .3882291
------------------------------------------------------------------------------

. assert abs(_b[ldlcbeta] - .429) < 1e-3

. assert abs(_se[ldlcbeta] - .041) < 1e-3

. assert abs(_b[hdlcbeta] - -.194) < 1e-3

. assert abs(_se[hdlcbeta] - .088) < 1e-3

. assert abs(_b[tgbeta] - .226) < 1e-3

. assert abs(_se[tgbeta] - .083) < 1e-3

. 
. discard

. mvmr chdbeta ldlcbeta hdlcbeta tgbeta [aw=1/(chdse^2)] if sel1==1, fe

                                                       Number of genotypes: 73
                                                 Standard errors: Fixed effect
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
chdbeta      |
    ldlcbeta |     .42862   .0409208    10.47   0.000     .3484166    .5088234
    hdlcbeta |  -.1941989   .0878132    -2.21   0.027    -.3663097   -.0220881
      tgbeta |   .2260456   .0827482     2.73   0.006     .0638621    .3882291
------------------------------------------------------------------------------

. assert abs(_b[ldlcbeta] - .429) < 1e-3

. assert abs(_se[ldlcbeta] - .041) < 1e-3

. assert abs(_b[hdlcbeta] - -.194) < 1e-3

. assert abs(_se[hdlcbeta] - .088) < 1e-3

. assert abs(_b[tgbeta] - .226) < 1e-3

. assert abs(_se[tgbeta] - .083) < 1e-3

. 
. ** 90% CI
. discard

. mrmvivw chdbeta ldlcbeta hdlcbeta tgbeta [aw=1/(chdse^2)] if sel1==1, level(9
> 0)

                                                       Number of genotypes: 73
                                                Standard errors: Random effect
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [90% Conf. Interval]
-------------+----------------------------------------------------------------
chdbeta      |
    ldlcbeta |     .42862   .0609661     7.03   0.000     .3283397    .5289003
    hdlcbeta |  -.1941989   .1308289    -1.48   0.138    -.4093933    .0209956
      tgbeta |   .2260456   .1232828     1.83   0.067     .0232635    .4288278
------------------------------------------------------------------------------

. mat table = r(table)

. assert abs(_b[ldlcbeta] - invnorm(.95)*_se[ldlcbeta] - .328) < 1e-3

. assert abs(_b[ldlcbeta] + invnorm(.95)*_se[ldlcbeta] - .529) < 1e-3

. 
. discard

. mvivw chdbeta ldlcbeta hdlcbeta tgbeta [aw=1/(chdse^2)] if sel1==1, level(90)

                                                       Number of genotypes: 73
                                                Standard errors: Random effect
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [90% Conf. Interval]
-------------+----------------------------------------------------------------
chdbeta      |
    ldlcbeta |     .42862   .0609661     7.03   0.000     .3283397    .5289003
    hdlcbeta |  -.1941989   .1308289    -1.48   0.138    -.4093933    .0209956
      tgbeta |   .2260456   .1232828     1.83   0.067     .0232635    .4288278
------------------------------------------------------------------------------

. mat table = r(table)

. assert abs(_b[ldlcbeta] - invnorm(.95)*_se[ldlcbeta] - .328) < 1e-3

. assert abs(_b[ldlcbeta] + invnorm(.95)*_se[ldlcbeta] - .529) < 1e-3

. 
. discard

. mvmr chdbeta ldlcbeta hdlcbeta tgbeta [aw=1/(chdse^2)] if sel1==1, level(90)

                                                       Number of genotypes: 73
                                                Standard errors: Random effect
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [90% Conf. Interval]
-------------+----------------------------------------------------------------
chdbeta      |
    ldlcbeta |     .42862   .0609661     7.03   0.000     .3283397    .5289003
    hdlcbeta |  -.1941989   .1308289    -1.48   0.138    -.4093933    .0209956
      tgbeta |   .2260456   .1232828     1.83   0.067     .0232635    .4288278
------------------------------------------------------------------------------

. mat table = r(table)

. assert abs(_b[ldlcbeta] - invnorm(.95)*_se[ldlcbeta] - .328) < 1e-3

. assert abs(_b[ldlcbeta] + invnorm(.95)*_se[ldlcbeta] - .529) < 1e-3

. 
. * eret list
. eret list

scalars:
                  e(N) =  73

macros:
            e(cmdline) : "mrmvivw chdbeta ldlcbeta hdlcbeta tgbeta [aw=1/(c.."
                e(cmd) : "mrmvivw"
             e(setype) : "re"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 3
                  e(V) :  3 x 3

. 
. * ret list
. ret list

scalars:
              r(level) =  90

macros:
           r(mcmethod) : "noadjust"

matrices:
              r(table) :  9 x 3

. 
. * Display
. discard

. mrmvivw chdbeta ldlcbeta [aw=1/(chdse^2)] if sel1==1, fe

                                                       Number of genotypes: 73
                                                 Standard errors: Fixed effect
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
chdbeta      |
    ldlcbeta |   .4815055    .038221    12.60   0.000     .4065938    .5564173
------------------------------------------------------------------------------

. mrmvivw

                                                       Number of genotypes: 73
                                                 Standard errors: Fixed effect
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
chdbeta      |
    ldlcbeta |   .4815055    .038221    12.60   0.000     .4065938    .5564173
------------------------------------------------------------------------------

. 
. assert `e(N)' == 73

. assert "`e(setype)'" == "fe"

. 
. discard

. mrmvivw chdbeta ldlcbeta [aw=1/(chdse^2)] if sel1==1

                                                       Number of genotypes: 73
                                                Standard errors: Random effect
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
chdbeta      |
    ldlcbeta |   .4815055   .0597994     8.05   0.000     .3643009    .5987101
------------------------------------------------------------------------------

. mrmvivw

                                                       Number of genotypes: 73
                                                Standard errors: Random effect
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
chdbeta      |
    ldlcbeta |   .4815055   .0597994     8.05   0.000     .3643009    .5987101
------------------------------------------------------------------------------

. assert "`e(setype)'" == "re"

. 
. * e(cmd), e(cmdline)
. discard

. mrmvivw chdbeta ldlcbeta [aw=1/(chdse^2)] if sel1==1

                                                       Number of genotypes: 73
                                                Standard errors: Random effect
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
chdbeta      |
    ldlcbeta |   .4815055   .0597994     8.05   0.000     .3643009    .5987101
------------------------------------------------------------------------------

. di e(cmd)
mrmvivw

. assert "`e(cmd)'" == "mrmvivw"

. di e(cmdline)
mrmvivw chdbeta ldlcbeta [aw=1/(chdse^2)] if sel1==1

. assert "`e(cmdline)'" == "mrmvivw chdbeta ldlcbeta [aw=1/(chdse^2)] if sel1==
> 1"

. 
end of do-file
      name:  mrmvivw
       log:  C:\Users\tom\Documents\GitHub\mrrobust\cscripts\mrmvivw.log
  log type:  text
 closed on:  27 Jun 2020, 22:57:13
-------------------------------------------------------------------------------
